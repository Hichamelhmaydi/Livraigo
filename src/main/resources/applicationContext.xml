<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:jpa="http://www.springframework.org/schema/data/jpa"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans.xsd
        http://www.springframework.org/schema/data/jpa
        http://www.springframework.org/schema/data/jpa/spring-jpa.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context.xsd">

    <!-- Scan for repositories -->
    <jpa:repositories base-package="com.livraigo.repository" entity-manager-factory-ref="entityManagerFactory" 
                      transaction-manager-ref="transactionManager"/>
    
    <!-- Model Mapper -->
    <bean id="modelMapper" class="org.modelmapper.ModelMapper"/>
    
    <!-- Utility Beans -->
    <bean id="distanceCalculator" class="com.livraigo.service.util.DistanceCalculator"/>
    <bean id="tourValidator" class="com.livraigo.service.util.TourValidator"/>
    <bean id="dateTimeUtil" class="com.livraigo.service.util.DateTimeUtil"/>
    
    <!-- Optimizer Beans -->
    <bean id="nearestNeighborOptimizer" class="com.livraigo.service.optimizer.NearestNeighborOptimizer">
        <constructor-arg ref="distanceCalculator"/>
    </bean>
    
    <bean id="clarkeWrightOptimizer" class="com.livraigo.service.optimizer.ClarkeWrightOptimizer">
        <constructor-arg ref="distanceCalculator"/>
    </bean>
    
    <!-- Mapper Beans -->
    <bean id="deliveryMapper" class="com.livraigo.mapper.DeliveryMapper">
        <constructor-arg ref="modelMapper"/>
    </bean>
    
    <bean id="tourMapper" class="com.livraigo.mapper.TourMapper">
        <constructor-arg ref="modelMapper"/>
    </bean>
    
    <bean id="vehicleMapper" class="com.livraigo.mapper.VehicleMapper">
        <constructor-arg ref="modelMapper"/>
    </bean>
    
    <bean id="warehouseMapper" class="com.livraigo.mapper.WarehouseMapper">
        <constructor-arg ref="modelMapper"/>
    </bean>
    
    <!-- Service Beans -->
    <bean id="deliveryService" class="com.livraigo.service.impl.DeliveryServiceImpl">
        <constructor-arg ref="deliveryRepository"/>
        <constructor-arg ref="deliveryMapper"/>
    </bean>
    
    <bean id="vehicleService" class="com.livraigo.service.impl.VehicleServiceImpl">
        <constructor-arg ref="vehicleRepository"/>
        <constructor-arg ref="vehicleMapper"/>
    </bean>
    
    <bean id="warehouseService" class="com.livraigo.service.impl.WarehouseServiceImpl">
        <constructor-arg ref="warehouseRepository"/>
        <constructor-arg ref="warehouseMapper"/>
    </bean>
    
    <bean id="tourService" class="com.livraigo.service.impl.TourServiceImpl">
        <constructor-arg ref="tourRepository"/>
        <constructor-arg ref="deliveryRepository"/>
        <constructor-arg ref="vehicleRepository"/>
        <constructor-arg ref="warehouseRepository"/>
        <constructor-arg ref="nearestNeighborOptimizer"/>
        <constructor-arg ref="clarkeWrightOptimizer"/>
        <constructor-arg ref="tourValidator"/>
        <constructor-arg ref="tourMapper"/>
    </bean>
    
    <!-- REST Controller Beans -->
    <bean id="deliveryController" class="com.livraigo.controller.DeliveryController">
        <constructor-arg ref="deliveryService"/>
    </bean>
    
    <bean id="vehicleController" class="com.livraigo.controller.VehicleController">
        <constructor-arg ref="vehicleService"/>
    </bean>
    
    <bean id="warehouseController" class="com.livraigo.controller.WarehouseController">
        <constructor-arg ref="warehouseService"/>
    </bean>
    
    <bean id="tourController" class="com.livraigo.controller.TourController">
        <constructor-arg ref="tourService"/>
    </bean>
    
    <!-- Web Controller Beans -->
    <bean id="webHomeController" class="com.livraigo.controller.web.WebHomeController"/>
    
    <bean id="webDeliveryController" class="com.livraigo.controller.web.WebDeliveryController">
        <constructor-arg ref="deliveryService"/>
    </bean>
    
    <bean id="webVehicleController" class="com.livraigo.controller.web.WebVehicleController">
        <constructor-arg ref="vehicleService"/>
    </bean>
    
    <bean id="webWarehouseController" class="com.livraigo.controller.web.WebWarehouseController">
        <constructor-arg ref="warehouseService"/>
    </bean>
    
    <bean id="webTourController" class="com.livraigo.controller.web.WebTourController">
        <constructor-arg ref="tourService"/>
        <constructor-arg ref="vehicleService"/>
        <constructor-arg ref="warehouseService"/>
        <constructor-arg ref="deliveryService"/>
    </bean>
</beans>